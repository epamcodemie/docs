<article class="doc">
 <h1 class="page">
  General Operations
 </h1>
 <div id="preamble">
  <div class="sectionbody">
   <div class="paragraph">
    <p>
     The Cryptography module provides operations to calculate and validate a checksum to check data for errors. These operations are independent of the encryption strategy used.
    </p>
   </div>
  </div>
 </div>
 <div class="sect1">
  <h2 id="checksum-overview">
   <a class="anchor" href="#checksum-overview">
   </a>
   Checksum Overview
  </h2>
  <div class="sectionbody">
   <div class="paragraph">
    <p>
     Checksum operations enable you to ensure message integrity. The Calculate Checksum operation acts as an enricher to generate a checksum for a message when it enters a system, and then the Validate Checksum operation acts as a filter to verify the checksum when the message leaves the system. If the entry and exit values do not match, a
     <code>
      CRYPTO:VALIDATION
     </code>
     error is raised.
    </p>
   </div>
   <div class="paragraph">
    <p>
     This pair of operations enables you to verify that a message remains intact between the sender and the receiver. Because checksum operations do not provide encryption or append a signature to the message, you can use the operations in conjunction with any other security features.
    </p>
   </div>
  </div>
 </div>
 <div class="sect1">
  <h2 id="calculateChecksum">
   <a class="anchor" href="#calculateChecksum">
   </a>
   Calculate Checksum
  </h2>
  <div class="sectionbody">
   <div class="paragraph">
    <p>
     <code>
      &lt;crypto:calculate-checksum&gt;
     </code>
    </p>
   </div>
   <div class="paragraph">
    <p>
     Calculates the checksum of a given content or value, which can be an expression. You can select the hashing algorithm to use.
    </p>
   </div>
   <div class="sect2">
    <h3 id="parameters">
     <a class="anchor" href="#parameters">
     </a>
     Parameters
    </h3>
    <table class="tableblock frame-all grid-all stretch">
     <colgroup>
      <col style="width: 20%;"/>
      <col style="width: 20%;"/>
      <col style="width: 35%;"/>
      <col style="width: 20%;"/>
      <col style="width: 5%;"/>
     </colgroup>
     <thead>
      <tr>
       <th class="tableblock halign-left valign-middle">
        Name
       </th>
       <th class="tableblock halign-left valign-middle">
        Type
       </th>
       <th class="tableblock halign-left valign-middle">
        Description
       </th>
       <th class="tableblock halign-left valign-middle">
        Default Value
       </th>
       <th class="tableblock halign-center valign-middle">
        Required
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td class="tableblock halign-left valign-middle">
        <p class="tableblock">
         Algorithm
        </p>
       </td>
       <td class="tableblock halign-left valign-middle">
        <div class="content">
         <div class="paragraph">
          <p>
           Enumeration, one of:
          </p>
         </div>
         <div class="ulist">
          <ul>
           <li>
            <p>
             <code>
              CRC32
             </code>
            </p>
           </li>
           <li>
            <p>
             <code>
              MD2
             </code>
            </p>
           </li>
           <li>
            <p>
             <code>
              MD5
             </code>
            </p>
           </li>
           <li>
            <p>
             <code>
              SHA_1
             </code>
            </p>
           </li>
           <li>
            <p>
             <code>
              SHA_256
             </code>
            </p>
           </li>
           <li>
            <p>
             <code>
              SHA_512
             </code>
            </p>
           </li>
          </ul>
         </div>
        </div>
       </td>
       <td class="tableblock halign-left valign-middle">
        <p class="tableblock">
         the checksum algorithm
        </p>
       </td>
       <td class="tableblock halign-left valign-middle">
        <p class="tableblock">
         <code>
          SHA_256
         </code>
        </p>
       </td>
       <td class="tableblock halign-center valign-middle">
        <p class="tableblock">
        </p>
       </td>
      </tr>
      <tr>
       <td class="tableblock halign-left valign-middle">
        <p class="tableblock">
         Content
        </p>
       </td>
       <td class="tableblock halign-left valign-middle">
        <div class="content">
         <div class="paragraph">
          <p>
           Binary
          </p>
         </div>
        </div>
       </td>
       <td class="tableblock halign-left valign-middle">
        <p class="tableblock">
         The content for calculating the checksum
        </p>
       </td>
       <td class="tableblock halign-left valign-middle">
        <p class="tableblock">
         <code>
          #[payload]
         </code>
        </p>
       </td>
       <td class="tableblock halign-center valign-middle">
        <p class="tableblock">
        </p>
       </td>
      </tr>
      <tr>
       <td class="tableblock halign-left valign-middle">
        <p class="tableblock">
         Target Variable
        </p>
       </td>
       <td class="tableblock halign-left valign-middle">
        <div class="content">
         <div class="paragraph">
          <p>
           String
          </p>
         </div>
        </div>
       </td>
       <td class="tableblock halign-left valign-middle">
        <p class="tableblock">
         The name of a variable on which the operation's output will be placed
        </p>
       </td>
       <td class="tableblock halign-left valign-middle">
       </td>
       <td class="tableblock halign-center valign-middle">
        <p class="tableblock">
        </p>
       </td>
      </tr>
      <tr>
       <td class="tableblock halign-left valign-middle">
        <p class="tableblock">
         Target Value
        </p>
       </td>
       <td class="tableblock halign-left valign-middle">
        <div class="content">
         <div class="paragraph">
          <p>
           String
          </p>
         </div>
        </div>
       </td>
       <td class="tableblock halign-left valign-middle">
        <p class="tableblock">
         An expression that will be evaluated against the operation's output and the outcome of that expression will be stored in the target variable
        </p>
       </td>
       <td class="tableblock halign-left valign-middle">
        <p class="tableblock">
         <code>
          #[payload]
         </code>
        </p>
       </td>
       <td class="tableblock halign-center valign-middle">
        <p class="tableblock">
        </p>
       </td>
      </tr>
     </tbody>
    </table>
   </div>
   <div class="sect2">
    <h3 id="output-type">
     <a class="anchor" href="#output-type">
     </a>
     Output Type
    </h3>
    <div class="paragraph">
     <p>
      String
     </p>
    </div>
   </div>
   <div class="sect2">
    <h3 id="throws">
     <a class="anchor" href="#throws">
     </a>
     Throws
    </h3>
    <div class="ulist">
     <ul>
      <li>
       <p>
        <code>
         CRYPTO:CHECKSUM
        </code>
       </p>
      </li>
     </ul>
    </div>
   </div>
  </div>
 </div>
 <div class="sect1">
  <h2 id="validateChecksum">
   <a class="anchor" href="#validateChecksum">
   </a>
   Validate Checksum
  </h2>
  <div class="sectionbody">
   <div class="paragraph">
    <p>
     <code>
      &lt;crypto:validate-checksum&gt;
     </code>
    </p>
   </div>
   <div class="paragraph">
    <p>
     Validates the checksum of the content or value against the checksum previously calculated using the Calculate Checksum operation.
    </p>
   </div>
   <div class="sect2">
    <h3 id="parameters-2">
     <a class="anchor" href="#parameters-2">
     </a>
     Parameters
    </h3>
    <table class="tableblock frame-all grid-all stretch">
     <colgroup>
      <col style="width: 20%;"/>
      <col style="width: 20%;"/>
      <col style="width: 35%;"/>
      <col style="width: 20%;"/>
      <col style="width: 5%;"/>
     </colgroup>
     <thead>
      <tr>
       <th class="tableblock halign-left valign-middle">
        Name
       </th>
       <th class="tableblock halign-left valign-middle">
        Type
       </th>
       <th class="tableblock halign-left valign-middle">
        Description
       </th>
       <th class="tableblock halign-left valign-middle">
        Default Value
       </th>
       <th class="tableblock halign-center valign-middle">
        Required
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td class="tableblock halign-left valign-middle">
        <p class="tableblock">
         Algorithm
        </p>
       </td>
       <td class="tableblock halign-left valign-middle">
        <div class="content">
         <div class="paragraph">
          <p>
           Enumeration, one of:
          </p>
         </div>
         <div class="ulist">
          <ul>
           <li>
            <p>
             <code>
              CRC32
             </code>
            </p>
           </li>
           <li>
            <p>
             <code>
              MD2
             </code>
            </p>
           </li>
           <li>
            <p>
             <code>
              MD5
             </code>
            </p>
           </li>
           <li>
            <p>
             <code>
              SHA_1
             </code>
            </p>
           </li>
           <li>
            <p>
             <code>
              SHA_256
             </code>
            </p>
           </li>
           <li>
            <p>
             <code>
              SHA_512
             </code>
            </p>
           </li>
          </ul>
         </div>
        </div>
       </td>
       <td class="tableblock halign-left valign-middle">
        <p class="tableblock">
         The checksum algorithm
        </p>
       </td>
       <td class="tableblock halign-left valign-middle">
        <p class="tableblock">
         <code>
          SHA_256
         </code>
        </p>
       </td>
       <td class="tableblock halign-center valign-middle">
        <p class="tableblock">
        </p>
       </td>
      </tr>
      <tr>
       <td class="tableblock halign-left valign-middle">
        <p class="tableblock">
         Value
        </p>
       </td>
       <td class="tableblock halign-left valign-middle">
        <div class="content">
         <div class="paragraph">
          <p>
           Binary
          </p>
         </div>
        </div>
       </td>
       <td class="tableblock halign-left valign-middle">
        <p class="tableblock">
         The content for calculating the checksum
        </p>
       </td>
       <td class="tableblock halign-left valign-middle">
        <p class="tableblock">
         <code>
          #[payload]
         </code>
        </p>
       </td>
       <td class="tableblock halign-center valign-middle">
        <p class="tableblock">
        </p>
       </td>
      </tr>
      <tr>
       <td class="tableblock halign-left valign-middle">
        <p class="tableblock">
         Expected
        </p>
       </td>
       <td class="tableblock halign-left valign-middle">
        <div class="content">
         <div class="paragraph">
          <p>
           String
          </p>
         </div>
        </div>
       </td>
       <td class="tableblock halign-left valign-middle">
        <p class="tableblock">
         The expected checksum as an hexadecimal string
        </p>
       </td>
       <td class="tableblock halign-left valign-middle">
       </td>
       <td class="tableblock halign-center valign-middle">
        <p class="tableblock">
         <strong>
          x
         </strong>
        </p>
       </td>
      </tr>
     </tbody>
    </table>
   </div>
   <div class="sect2">
    <h3 id="throws-2">
     <a class="anchor" href="#throws-2">
     </a>
     Throws
    </h3>
    <div class="ulist">
     <ul>
      <li>
       <p>
        <code>
         CRYPTO:MISSING_KEY
        </code>
       </p>
      </li>
      <li>
       <p>
        <code>
         CRYPTO:VALIDATION
        </code>
       </p>
      </li>
     </ul>
    </div>
   </div>
  </div>
 </div>
 <div class="sect1">
  <h2 id="configure-use-random-initialization-vectors">
   <a class="anchor" href="#configure-use-random-initialization-vectors">
   </a>
   Configure Use Random Initialization Vectors
  </h2>
  <div class="sectionbody">
   <div class="paragraph">
    <p>
     You can enable the
     <strong>
      Use random IVs
     </strong>
     field to use random initialization vectors (IVs). If you enable this field, the decryption algorithm assumes IVs are prepended to the ciphertext during the decryption operation. To configure this field in Anypoint Studio, follow these steps:
    </p>
   </div>
   <div class="olist arabic">
    <ol class="arabic">
     <li>
      <p>
       In Studio, drag a Cryptography module operation to your flow, for example
       <strong>
        Jce sign
       </strong>
       .
      </p>
     </li>
     <li>
      <p>
       Select the operation from the flow.
      </p>
     </li>
     <li>
      <p>
       In the operation configuration screen, click the plus sign to access the module global configuration.
      </p>
     </li>
     <li>
      <p>
       In the
       <strong>
        Global Element Properties
       </strong>
       window, enable the
       <strong>
        Use random IVs
       </strong>
       field.
      </p>
     </li>
    </ol>
   </div>
   <div class="imageblock">
    <div class="content">
     <img alt="A configuration setting for Crypto JCE with options for keystore and random IV usage" src="_images/crypto-random-iv.png"/>
    </div>
   </div>
   <div class="paragraph">
    <p>
     In the
     <strong>
      XML editor
     </strong>
     window, the
     <strong>
      Use random IVs
     </strong>
     field looks like this:
    </p>
   </div>
   <div class="listingblock">
    <div class="content">
     <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">crypto:jce-config name="Crypto_Jce" doc:name="Crypto Jce" keystore="/Users/MuleSoft/Desktop/jcekeystore.jks" password="mulesoft" useRandomIVs="true"&gt;
		&lt;crypto:jce-key-infos &gt;
			&lt;crypto:jce-symmetric-key-info keyId="key100" alias="jceclient100" password="mulesoft" /&gt;
		&lt;/crypto:jce-key-infos&gt;
	&lt;/crypto:jce-config&gt;</code></pre>
    </div>
   </div>
  </div>
 </div>
</article>
