<article class="doc">
 <h1 class="page">
  Secure Configuration Properties
 </h1>
 <div id="preamble">
  <div class="sectionbody">
   <div class="paragraph">
    <p>
     You can encrypt configuration properties as another security level for your applications. To create secure configuration properties, review the following process:
    </p>
   </div>
   <div class="olist arabic">
    <ol class="arabic">
     <li>
      <p>
       Create a secure configuration properties file.
      </p>
     </li>
     <li>
      <p>
       Define secure properties in the file by enclosing the encrypted values between the sequence
       <code>
        ![value]
       </code>
       .
      </p>
     </li>
     <li>
      <p>
       Configure the file in the project with the Mule Secure Configuration Properties Extension module. The file must point to or include the decryption key.
      </p>
     </li>
    </ol>
   </div>
  </div>
 </div>
 <div class="sect1">
  <h2 id="attributes">
   <a class="anchor" href="#attributes">
   </a>
   Attributes
  </h2>
  <div class="sectionbody">
   <div class="paragraph">
    <p>
     Before you create a secure properties file and define its properties, review the secure configuration properties attributes and encrypting attributes used in the process:
    </p>
   </div>
   <table class="tableblock frame-all grid-all stretch">
    <caption class="title">
     Table 1. Secure Configuration Properties Attributes
    </caption>
    <colgroup>
     <col style="width: 25%;"/>
     <col style="width: 75%;"/>
    </colgroup>
    <thead>
     <tr>
      <th class="tableblock halign-left valign-top">
       Attribute Name
      </th>
      <th class="tableblock halign-left valign-top">
       Description
      </th>
     </tr>
    </thead>
    <tbody>
     <tr>
      <td class="tableblock halign-left valign-top">
       <p class="tableblock">
        Name
       </p>
      </td>
      <td class="tableblock halign-left valign-top">
       <p class="tableblock">
        A unique name for your global secure configuration properties.
       </p>
      </td>
     </tr>
     <tr>
      <td class="tableblock halign-left valign-top">
       <p class="tableblock">
        Key
       </p>
      </td>
      <td class="tableblock halign-left valign-top">
       <p class="tableblock">
        A word or phrase that you specify to unlock the properties value. For example,
        <code>
         ${production.myproperty}
        </code>
        instructs the Mule runtime engine to demand the key at runtime.
       </p>
      </td>
     </tr>
     <tr>
      <td class="tableblock halign-left valign-top">
       <p class="tableblock">
        File
       </p>
      </td>
      <td class="tableblock halign-left valign-top">
       <p class="tableblock">
        The location of the file that the key unlocks.
       </p>
      </td>
     </tr>
     <tr>
      <td class="tableblock halign-left valign-top">
       <p class="tableblock">
        Encoding
       </p>
      </td>
      <td class="tableblock halign-left valign-top">
       <p class="tableblock">
        Encoding of the file that the key unlocks. The default value is UTF-8.
       </p>
      </td>
     </tr>
     <tr>
      <td class="tableblock halign-left valign-top">
       <p class="tableblock">
        File Level Encryption
       </p>
      </td>
      <td class="tableblock halign-left valign-top">
       <p class="tableblock">
        Set to
        <code>
         true
        </code>
        if the file itself is entirely encrypted. Default value is
        <code>
         false
        </code>
        .
       </p>
      </td>
     </tr>
    </tbody>
   </table>
   <table class="tableblock frame-all grid-all stretch">
    <caption class="title">
     Table 2. Secure Configuration Properties Encrypting Attributes
    </caption>
    <colgroup>
     <col style="width: 25%;"/>
     <col style="width: 75%;"/>
    </colgroup>
    <thead>
     <tr>
      <th class="tableblock halign-left valign-top">
       Attribute Name
      </th>
      <th class="tableblock halign-left valign-top">
       Description
      </th>
     </tr>
    </thead>
    <tbody>
     <tr>
      <td class="tableblock halign-left valign-top">
       <p class="tableblock">
        Algorithm
       </p>
      </td>
      <td class="tableblock halign-left valign-top">
       <p class="tableblock">
        The type of algorithm you use to encrypt the content of the property. See
        <a href="#supported_algorithms">
         Supported Algorithms
        </a>
        for a complete list.
       </p>
      </td>
     </tr>
     <tr>
      <td class="tableblock halign-left valign-top">
       <p class="tableblock">
        Mode
       </p>
      </td>
      <td class="tableblock halign-left valign-top">
       <p class="tableblock">
        The procedure that allows the Mule runtime engine to repeatedly use a block cipher with a single key. See
        <a href="#supported_modes">
         Supported Modes
        </a>
        for a full list.
       </p>
      </td>
     </tr>
     <tr>
      <td class="tableblock halign-left valign-top">
       <p class="tableblock">
        Use random IVs
       </p>
      </td>
      <td class="tableblock halign-left valign-top">
       <p class="tableblock">
        Set this attribute to
        <code>
         true
        </code>
        to use random initialization vectors (IVs). If this option is set to
        <code>
         true
        </code>
        , the decryption algorithm assumes IVs are prepended to the ciphertext during decryption operations.
       </p>
      </td>
     </tr>
    </tbody>
   </table>
  </div>
 </div>
 <div class="sect1">
  <h2 id="create-a-secure-configuration-properties-file">
   <a class="anchor" href="#create-a-secure-configuration-properties-file">
   </a>
   Create a Secure Configuration Properties File
  </h2>
  <div class="sectionbody">
   <div class="paragraph">
    <p>
     The first task in securing configuration properties is to create a YAML configuration file (
     <code>
      .yaml
     </code>
     ) or a Spring-formatted Properties file (
     <code>
      .properties
     </code>
     ), where you define the properties. The Mule Secure Configuration Properties Extension module enables you to configure YAML or Properties file types.
     <br/>
    </p>
   </div>
   <div class="paragraph">
    <p>
     You can create secure configuration properties files either in
     <code>
      src/main/resources
     </code>
     in your Mule project, or by using absolute paths.
    </p>
   </div>
  </div>
 </div>
 <div class="sect1">
  <h2 id="define-secure-configuration-properties-in-the-file">
   <a class="anchor" href="#define-secure-configuration-properties-in-the-file">
   </a>
   Define Secure Configuration Properties in the File
  </h2>
  <div class="sectionbody">
   <div class="paragraph">
    <p>
     Define secure properties in the file by enclosing the encrypted values between the sequence
     <code>
      ![value]
     </code>
     . The file can contain both encrypted and nonencrypted values that could be used anywhere in the Mule application.
     <br/>
    </p>
   </div>
   <div class="admonitionblock caution">
    <table>
     <tr>
      <td class="icon">
       <i class="fa icon-caution" title="Caution">
       </i>
      </td>
      <td class="content">
       Secure access to the operating system. Anyone who can run a
       <code>
        ps
       </code>
       command or view a Java console will be able to see the decrypted values that are stored in the Mule app’s memory.
      </td>
     </tr>
    </table>
   </div>
   <div class="paragraph">
    <p>
     The following
     <code>
      file1.yaml
     </code>
     example contains both encrypted and nonencrypted configuration properties values:
    </p>
   </div>
   <div class="listingblock">
    <div class="content">
     <pre>encrypted:
    value1: "![nHWo5JhNAYM+TzxqeHdRDXx15Q5R56YVGiQgXCoBCew=]"
    value2: "![nHWo6XyCADP+TzxqeHdRDXx15Q5R56YVGiQgXCoDFaj=]"

testPropertyA: "testValueA"
testPropertyB: "testValueB"</pre>
    </div>
   </div>
   <div class="admonitionblock note">
    <table>
     <tr>
      <td class="icon">
       <i class="fa icon-note" title="Note">
       </i>
      </td>
      <td class="content">
       The encrypted value must be enclosed in quotes so that it is read as a string.
      </td>
     </tr>
    </table>
   </div>
   <div class="paragraph">
    <p>
     The following
     <code>
      file1.properties
     </code>
     example contains the configuration properties used in the previous example but uses a Spring-formatted properties file:
    </p>
   </div>
   <div class="listingblock">
    <div class="content">
     <pre>encrypted.value1=![nHWo5JhNAYM+TzxqeHdRDXx15Q5R56YVGiQgXCoBCew=]
encrypted.value2=![nHWo6XyCADP+TzxqeHdRDXx15Q5R56YVGiQgXCoDFaj=]

testPropertyA=testValueA
testPropertyB=testValueB</pre>
    </div>
   </div>
  </div>
 </div>
 <div class="sect1">
  <h2 id="secure_props_tool">
   <a class="anchor" href="#secure_props_tool">
   </a>
   Encrypt Properties Using the Secure Properties Tool
  </h2>
  <div class="sectionbody">
   <div class="paragraph">
    <p>
     Use the Secure Properties Tool to encrypt or decrypt text strings, values inside a properties file, or all the contents of a properties file.
    </p>
   </div>
   <div class="paragraph">
    <p>
     Ensure that you have the latest available version of this tool to use all the functions detailed in this article.
     <br/>
    </p>
   </div>
   <div class="paragraph">
    <p>
     <a class="xref attachment" href="_attachments/secure-properties-tool-j17.jar">
      Secure Properties Tool Jar file - Supports Java 17
     </a>
     .
     <br/>
     Latest release: 11/22/2024.
    </p>
   </div>
   <div class="paragraph">
    <p>
     Note that the syntax has changed from earlier versions. To avoid issues, use the syntax and the JAR file provided in this article. Also, the tool doesn’t support the hash character
     <code>
      #
     </code>
     in the input text.git st
    </p>
   </div>
   <div class="paragraph">
    <p>
     See
     <a href="#parameter-reference">
      Parameters Reference
     </a>
     for a complete list and definition of all accepted parameters.
    </p>
   </div>
   <div class="sect2">
    <h3 id="encrypt-text-strings">
     <a class="anchor" href="#encrypt-text-strings">
     </a>
     Encrypt Text Strings
    </h3>
    <div class="paragraph">
     <p>
      Use the following syntax to encrypt or decrypt a text string provided as a parameter:
     </p>
    </div>
    <div class="listingblock">
     <div class="content">
      <pre class="highlightjs highlight"><code class="language-console.linenums hljs" data-lang="console.linenums">java -cp secure-properties-tool.jar com.mulesoft.tools.SecurePropertiesTool \
&lt;method&gt; \
&lt;operation&gt; \
&lt;algorithm&gt; \
&lt;mode&gt; \
&lt;key&gt; \
&lt;value&gt; \
--use-random-iv [optional]</code></pre>
     </div>
    </div>
    <div class="ulist">
     <ul>
      <li>
       <p>
        Set
        <code>
         &lt;method&gt;
        </code>
        to
        <code>
         string
        </code>
        to configure the tool to process a text string.
        <br/>
       </p>
      </li>
      <li>
       <p>
        Specify the other parameters to perform your desired operation.
       </p>
      </li>
     </ul>
    </div>
    <div class="paragraph">
     <p>
      For example, if you run:
     </p>
    </div>
    <div class="listingblock">
     <div class="content">
      <pre class="highlightjs highlight"><code class="language-console.linenums hljs" data-lang="console.linenums">java -cp secure-properties-tool.jar com.mulesoft.tools.SecurePropertiesTool \
string \
encrypt \
Blowfish \
CBC \
mulesoft \
"some value to encrypt"</code></pre>
     </div>
    </div>
    <div class="paragraph">
     <p>
      The tool returns:
     </p>
    </div>
    <div class="listingblock">
     <div class="content">
      <pre class="highlightjs highlight"><code class="language-console.linenums hljs" data-lang="console.linenums">8q5e1+jy0cND2iV2WPThahmz6XsDwB6Z</code></pre>
     </div>
    </div>
   </div>
   <div class="sect2">
    <h3 id="encrypt-files">
     <a class="anchor" href="#encrypt-files">
     </a>
     Encrypt Files
    </h3>
    <div class="paragraph">
     <p>
      In addition to processing strings, the encryption tool processes
      <code>
       .yaml
      </code>
      or
      <code>
       .properties
      </code>
      files. You can encrypt or decrypt the values inside a properties file, or all the file’s content.
     </p>
    </div>
    <div class="sect3">
     <h4 id="encrypt-properties-inside-a-file">
      <a class="anchor" href="#encrypt-properties-inside-a-file">
      </a>
      Encrypt Properties Inside a File
     </h4>
     <div class="paragraph">
      <p>
       Use the following syntax to encrypt or decrypt all values inside a properties file:
      </p>
     </div>
     <div class="listingblock">
      <div class="content">
       <pre class="highlightjs highlight"><code class="language-console.linenums hljs" data-lang="console.linenums">java -cp secure-properties-tool.jar com.mulesoft.tools.SecurePropertiesTool \
&lt;method&gt; \
&lt;operation&gt; \
&lt;algorithm&gt; \
&lt;mode&gt; \
&lt;key&gt; \
&lt;input file&gt; \
&lt;output file&gt; \
--use-random-iv [optional]</code></pre>
      </div>
     </div>
     <div class="ulist">
      <ul>
       <li>
        <p>
         Set
         <code>
          &lt;method&gt;
         </code>
         to
         <code>
          file
         </code>
         .
         <br/>
        </p>
       </li>
       <li>
        <p>
         Set
         <code>
          &lt;input file&gt;
         </code>
         to the properties file to process.
         <br/>
        </p>
       </li>
       <li>
        <p>
         Set
         <code>
          &lt;output file&gt;
         </code>
         to the file that is generated after the process.
         <br/>
        </p>
       </li>
       <li>
        <p>
         Specify the other parameters to perform your desired operation.
        </p>
       </li>
      </ul>
     </div>
     <div class="paragraph">
      <p>
       For example, consider the file
       <code>
        example_in.yaml
       </code>
       with the following content:
      </p>
     </div>
     <div class="listingblock">
      <div class="content">
       <pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">properties:
  example1:
    value: "Muleman is here"
  example2: "Max the mule"</code></pre>
      </div>
     </div>
     <div class="paragraph">
      <p>
       If you run:
      </p>
     </div>
     <div class="listingblock">
      <div class="content">
       <pre class="highlightjs highlight"><code class="language-console.linenums hljs" data-lang="console.linenums">java -cp secure-properties-tool.jar com.mulesoft.tools.SecurePropertiesTool \
file \
encrypt \
Blowfish \
CBC \
mulesoft \
example_in.yaml \
example_out.yaml</code></pre>
      </div>
     </div>
     <div class="paragraph">
      <p>
       The tool generates the file
       <code>
        example_out.yaml
       </code>
       with the following content:
      </p>
     </div>
     <div class="listingblock">
      <div class="content">
       <pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">properties:
  example1:
    value: "![qCReIPK3jcqD7WR84ISSIQ==]"
  example2: "![En8lII21ZHrdIaINw0+mSA==]"</code></pre>
      </div>
     </div>
    </div>
    <div class="sect3">
     <h4 id="encrypt-all-the-content-of-a-file">
      <a class="anchor" href="#encrypt-all-the-content-of-a-file">
      </a>
      Encrypt All the Content of a File
     </h4>
     <div class="paragraph">
      <p>
       Use the following syntax to encrypt or decrypt all the content of a properties file:
      </p>
     </div>
     <div class="listingblock">
      <div class="content">
       <pre class="highlightjs highlight"><code class="language-console.linenums hljs" data-lang="console.linenums">java -cp secure-properties-tool.jar com.mulesoft.tools.SecurePropertiesTool \
&lt;method&gt; \
&lt;operation&gt; \
&lt;algorithm&gt; \
&lt;mode&gt; \
&lt;key&gt; \
&lt;input file&gt; \
&lt;output file&gt;
--use-random-iv [optional]</code></pre>
      </div>
     </div>
     <div class="ulist">
      <ul>
       <li>
        <p>
         Set
         <code>
          &lt;method&gt;
         </code>
         to
         <code>
          file-level
         </code>
         .
         <br/>
        </p>
       </li>
       <li>
        <p>
         Set
         <code>
          &lt;input file&gt;
         </code>
         to the properties file to process.
         <br/>
        </p>
       </li>
       <li>
        <p>
         Set
         <code>
          &lt;output file&gt;
         </code>
         to the file that is generated after the process.
         <br/>
        </p>
       </li>
       <li>
        <p>
         Specify the other parameters to perform your desired operation.
        </p>
       </li>
      </ul>
     </div>
     <div class="paragraph">
      <p>
       For example, consider the file
       <code>
        example_in.yaml
       </code>
       with the following content:
      </p>
     </div>
     <div class="listingblock">
      <div class="content">
       <pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">properties:
  example1:
    value: "Muleman is here"
  example2: "Max the mule"</code></pre>
      </div>
     </div>
     <div class="paragraph">
      <p>
       If you run:
      </p>
     </div>
     <div class="listingblock">
      <div class="content">
       <pre class="highlightjs highlight"><code class="language-console.linenums hljs" data-lang="console.linenums">java -cp secure-properties-tool.jar com.mulesoft.tools.SecurePropertiesTool \
file-level \
encrypt \
Blowfish \
CBC \
mulesoft \
example_in.yaml \
example_out.yaml</code></pre>
      </div>
     </div>
     <div class="paragraph">
      <p>
       The tool generates the file
       <code>
        example_out.yaml
       </code>
       with the following content:
      </p>
     </div>
     <div class="listingblock">
      <div class="content">
       <pre class="highlightjs highlight"><code class="language-txt hljs" data-lang="txt">k/J1EHyxJagOcyQELoaqIDCzzKc1bLGJiHY2dv6jzuhtVpP1LTlgK3y8EH7OkK5iuuu8kik3P5dCDMixZXwn/EV6xbUwLFKnEb4x1pUX6aopLP/KULm0pQ==</code></pre>
      </div>
     </div>
    </div>
   </div>
   <div class="sect2">
    <h3 id="parameter-reference">
     <a class="anchor" href="#parameter-reference">
     </a>
     Parameters Reference
    </h3>
    <table class="tableblock frame-all grid-all stretch">
     <colgroup>
      <col style="width: 20%;"/>
      <col style="width: 80%;"/>
     </colgroup>
     <thead>
      <tr>
       <th class="tableblock halign-left valign-top">
        Parameter
       </th>
       <th class="tableblock halign-left valign-top">
        Description
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td class="tableblock halign-left valign-top">
        <div class="content">
         <div class="paragraph">
          <p>
           <code>
            &lt;method&gt;
           </code>
          </p>
         </div>
        </div>
       </td>
       <td class="tableblock halign-left valign-top">
        <div class="content">
         <div class="paragraph">
          <p>
           Sets the encryption or decryption method. Accepted values are:
          </p>
         </div>
         <table class="tableblock frame-all grid-all fit-content spread">
          <colgroup>
           <col/>
           <col/>
          </colgroup>
          <tbody>
           <tr>
            <td class="tableblock halign-left valign-top">
             <div class="content">
              <div class="paragraph">
               <p>
                <code>
                 string
                </code>
               </p>
              </div>
             </div>
            </td>
            <td class="tableblock halign-left valign-top">
             <div class="content">
              <div class="paragraph">
               <p>
                Encrypts a single text string provided as parameter
                <code>
                 &lt;value&gt;
                </code>
                .
               </p>
              </div>
             </div>
            </td>
           </tr>
           <tr>
            <td class="tableblock halign-left valign-top">
             <div class="content">
              <div class="paragraph">
               <p>
                <code>
                 file
                </code>
               </p>
              </div>
             </div>
            </td>
            <td class="tableblock halign-left valign-top">
             <div class="content">
              <div class="paragraph">
               <p>
                Encrypts the value of each property set in the properties file provided as parameter
                <code>
                 &lt;input file&gt;
                </code>
                .
               </p>
              </div>
             </div>
            </td>
           </tr>
           <tr>
            <td class="tableblock halign-left valign-top">
             <div class="content">
              <div class="paragraph">
               <p>
                <code>
                 file-level
                </code>
               </p>
              </div>
             </div>
            </td>
            <td class="tableblock halign-left valign-top">
             <div class="content">
              <div class="paragraph">
               <p>
                Encrypts all the content of the properties file provided as parameter
                <code>
                 &lt;input file&gt;
                </code>
                .
               </p>
              </div>
             </div>
            </td>
           </tr>
          </tbody>
         </table>
        </div>
       </td>
      </tr>
      <tr>
       <td class="tableblock halign-left valign-top">
        <div class="content">
         <div class="paragraph">
          <p>
           <code>
            &lt;operation&gt;
           </code>
          </p>
         </div>
        </div>
       </td>
       <td class="tableblock halign-left valign-top">
        <div class="content">
         <div class="paragraph">
          <p>
           Sets the operation to perform. Accepted values are:
          </p>
         </div>
         <table class="tableblock frame-all grid-all fit-content spread">
          <colgroup>
           <col/>
           <col/>
          </colgroup>
          <tbody>
           <tr>
            <td class="tableblock halign-left valign-top">
             <div class="content">
              <div class="paragraph">
               <p>
                <code>
                 encrypt
                </code>
               </p>
              </div>
             </div>
            </td>
            <td class="tableblock halign-left valign-top">
             <div class="content">
              <div class="paragraph">
               <p>
                Sets the operation to encryption.
               </p>
              </div>
             </div>
            </td>
           </tr>
           <tr>
            <td class="tableblock halign-left valign-top">
             <div class="content">
              <div class="paragraph">
               <p>
                <code>
                 decrypt
                </code>
               </p>
              </div>
             </div>
            </td>
            <td class="tableblock halign-left valign-top">
             <div class="content">
              <div class="paragraph">
               <p>
                Sets the operation to decryption.
               </p>
              </div>
             </div>
            </td>
           </tr>
          </tbody>
         </table>
        </div>
       </td>
      </tr>
      <tr>
       <td class="tableblock halign-left valign-top">
        <div class="content">
         <div class="paragraph">
          <p>
           <code>
            &lt;algorithm&gt;
           </code>
          </p>
         </div>
        </div>
       </td>
       <td class="tableblock halign-left valign-top">
        <div class="content">
         <div class="paragraph">
          <p>
           Specifies the algorithm to use during the operation.
           <br/>
           See
           <a href="#supported_algorithms">
            Supported Algorithms
           </a>
           for a complete list.
          </p>
         </div>
        </div>
       </td>
      </tr>
      <tr>
       <td class="tableblock halign-left valign-top">
        <div class="content">
         <div class="paragraph">
          <p>
           <code>
            &lt;mode&gt;
           </code>
          </p>
         </div>
        </div>
       </td>
       <td class="tableblock halign-left valign-top">
        <div class="content">
         <div class="paragraph">
          <p>
           Specifies the mode to use during the operation.
           <br/>
           See
           <a href="#supported_modes">
            Supported Modes
           </a>
           for a full list.
          </p>
         </div>
        </div>
       </td>
      </tr>
      <tr>
       <td class="tableblock halign-left valign-top">
        <div class="content">
         <div class="paragraph">
          <p>
           <code>
            &lt;key&gt;
           </code>
          </p>
         </div>
        </div>
       </td>
       <td class="tableblock halign-left valign-top">
        <div class="content">
         <div class="paragraph">
          <p>
           Specifies the word used to lock or unlock the file or value during the operation.
           <br/>
          </p>
         </div>
         <div class="admonitionblock note">
          <table>
           <tr>
            <td class="icon">
             <i class="fa icon-note" title="Note">
             </i>
            </td>
            <td class="content">
             <div class="ulist">
              <ul>
               <li>
                <p>
                 If you use the
                 <code>
                  $
                 </code>
                 character in your key, you must precede it with
                 <code>
                  \
                 </code>
                 .
For example, to use key
                 <code>
                  myKey#$%123
                 </code>
                 , you must specify the
                 <code>
                  &lt;key&gt;
                 </code>
                 parameter as
                 <code>
                  myKey#\$%123
                 </code>
                 .
                 <br/>
                </p>
               </li>
               <li>
                <p>
                 Beginning with Java Cryptography Extension (JCE) version 1.8.0_161, the AES key size must be of 32 characters (128 bits).
                </p>
               </li>
              </ul>
             </div>
            </td>
           </tr>
          </table>
         </div>
        </div>
       </td>
      </tr>
      <tr>
       <td class="tableblock halign-left valign-top">
        <div class="content">
         <div class="paragraph">
          <p>
           <code>
            &lt;value&gt;
           </code>
          </p>
         </div>
        </div>
       </td>
       <td class="tableblock halign-left valign-top">
        <div class="content">
         <div class="paragraph">
          <p>
           Specifies the string value that is encrypted or decrypted during the
           <code>
            string
           </code>
           operation.
          </p>
         </div>
        </div>
       </td>
      </tr>
      <tr>
       <td class="tableblock halign-left valign-top">
        <div class="content">
         <div class="paragraph">
          <p>
           <code>
            &lt;use random IV&gt;
           </code>
          </p>
         </div>
        </div>
       </td>
       <td class="tableblock halign-left valign-top">
        <div class="content">
         <div class="paragraph">
          <p>
           Specifies if random initialization vectors (IVs) are used during the operation.
          </p>
         </div>
        </div>
       </td>
      </tr>
      <tr>
       <td class="tableblock halign-left valign-top">
        <div class="content">
         <div class="paragraph">
          <p>
           <code>
            &lt;input file&gt;
           </code>
          </p>
         </div>
        </div>
       </td>
       <td class="tableblock halign-left valign-top">
        <div class="content">
         <div class="paragraph">
          <p>
           Specifies the properties file that is encrypted or decrypted during the
           <code>
            file
           </code>
           or
           <code>
            file-level
           </code>
           operation.
          </p>
         </div>
        </div>
       </td>
      </tr>
      <tr>
       <td class="tableblock halign-left valign-top">
        <div class="content">
         <div class="paragraph">
          <p>
           <code>
            &lt;output file&gt;
           </code>
          </p>
         </div>
        </div>
       </td>
       <td class="tableblock halign-left valign-top">
        <div class="content">
         <div class="paragraph">
          <p>
           Specifies the encrypted or decrypted properties file that is created after the
           <code>
            file
           </code>
           or
           <code>
            file-level
           </code>
           operation.
          </p>
         </div>
        </div>
       </td>
      </tr>
     </tbody>
    </table>
   </div>
  </div>
 </div>
 <div class="sect1">
  <h2 id="configure-the-file-in-the-project">
   <a class="anchor" href="#configure-the-file-in-the-project">
   </a>
   Configure the File in the Project
  </h2>
  <div class="sectionbody">
   <div class="paragraph">
    <p>
     You can configure a secure properties file both in standalone XML or in Anypoint Studio, with the Mule Secure Configuration Properties Extension module available from
     <a href="https://anypoint.mulesoft.com/exchange/com.mulesoft.modules/mule-secure-configuration-property-module/">
      Exchange
     </a>
     .
    </p>
   </div>
   <div class="sect2">
    <h3 id="configure-the-file-with-the-extension-module-in-xml">
     <a class="anchor" href="#configure-the-file-with-the-extension-module-in-xml">
     </a>
     Configure the File with the Extension Module in XML
    </h3>
    <div class="paragraph">
     <p>
      In your XML flow, use the module
      <code>
       &lt;secure-properties:config&gt;
      </code>
      to configure the file. Review the following example:
      <br/>
     </p>
    </div>
    <div class="paragraph">
     <p>
      <strong>
       Secure Configuration Properties with Default Values
      </strong>
     </p>
    </div>
    <div class="listingblock">
     <div class="content">
      <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;secure-properties:config key="${runtime.property}"
  file="file1.yaml" name="test"&gt;
    &lt;secure-properties:encrypt/&gt;
&lt;/secure-properties:config&gt;

&lt;global-property name="prop" value="my-${secure::property.key1}"/&gt;</code></pre>
     </div>
    </div>
    <div class="ulist">
     <ul>
      <li>
       <p>
        The
        <code>
         &lt;secure-properties:encrypt&gt;
        </code>
        tag is required even when using the default values.
       </p>
      </li>
      <li>
       <p>
        The prefix
        <code>
         secure::
        </code>
        is required for loading the key.
       </p>
       <div class="admonitionblock note">
        <table>
         <tr>
          <td class="icon">
           <i class="fa icon-note" title="Note">
           </i>
          </td>
          <td class="content">
           You have to use the
           <code>
            secure::
           </code>
           prefix to access all values inside a secure properties file, even if the values are not encrypted. Doing this enables you to switch between files (or environments) without changing the entire configuration.
          </td>
         </tr>
        </table>
       </div>
      </li>
      <li>
       <p>
        At deployment time, a decryption key is passed into the Mule runtime engine as a system environment variable
        <code>
         runtime.property
        </code>
        . This property must be the exact key used to encrypt the values stored in the
        <code>
         file1.yaml
        </code>
        file.
       </p>
      </li>
      <li>
       <p>
        The default encryption algorithm and mode is used.
       </p>
      </li>
      <li>
       <p>
        If the actual (decrypted) value of the property
        <code>
         property.key1
        </code>
        is, for example,
        <code>
         "property"
        </code>
        , the value of the property
        <code>
         prop
        </code>
        is
        <code>
         "my-property"
        </code>
        .
       </p>
      </li>
     </ul>
    </div>
    <div class="paragraph">
     <p>
      You can also change the encryption algorithm and crypto mode by setting additional attributes of the
      <code>
       &lt;secure-properties:encrypt&gt;
      </code>
      tag:
     </p>
    </div>
    <div class="paragraph">
     <p>
      <strong>
       Secure Configuration Properties with Custom Values
      </strong>
     </p>
    </div>
    <div class="listingblock">
     <div class="content">
      <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;secure-properties:config key="${runtime.property}"
  file="file1.properties" name="test"&gt;
    &lt;secure-properties:encrypt algorithm="AES" mode="CBC" useRandomIVs="true"/&gt;
&lt;/secure-properties:config&gt;</code></pre>
     </div>
    </div>
    <div class="paragraph">
     <p>
      In the previous example, the
      <code>
       &lt;secure-properties:encrypt&gt;
      </code>
      tag uses the
      <code>
       AES
      </code>
      algorithm with
      <code>
       CBC
      </code>
      mode and
      <code>
       random IV
      </code>
      .
     </p>
    </div>
    <div class="admonitionblock note">
     <table>
      <tr>
       <td class="icon">
        <i class="fa icon-note" title="Note">
        </i>
       </td>
       <td class="content">
        <div class="paragraph">
         <p>
          The
          <code>
           key
          </code>
          ,
          <code>
           algorithm
          </code>
          ,
          <code>
           mode
          </code>
          and
          <code>
           useRandomIVs
          </code>
          values set in
          <code>
           &lt;secure-properties:config&gt;
          </code>
          must match the values used to encrypt the properties files.
         </p>
        </div>
       </td>
      </tr>
     </table>
    </div>
   </div>
   <div class="sect2">
    <h3 id="configure-the-file-with-the-extension-module-in-studio">
     <a class="anchor" href="#configure-the-file-with-the-extension-module-in-studio">
     </a>
     Configure the File with the Extension Module in Studio
    </h3>
    <div class="paragraph">
     <p>
      If you are developing applications using Anypoint Studio, you can also create secure configuration properties using the module by adding it as a dependency in your Mule app.
     </p>
    </div>
    <div class="sect3">
     <h4 id="install-the-extension-module">
      <a class="anchor" href="#install-the-extension-module">
      </a>
      Install the Extension Module
     </h4>
     <div class="olist arabic">
      <ol class="arabic">
       <li>
        <p>
         Open your Mule project in Anypoint Studio.
        </p>
       </li>
       <li>
        <p>
         Go to the Mule Palette section.
        </p>
       </li>
       <li>
        <p>
         Click
         <strong>
          Search in Exchange
         </strong>
         .
        </p>
       </li>
       <li>
        <p>
         In the Add Module to Project window, search for
         <strong>
          Mule Secure Configuration Property Extension
         </strong>
         in the
         <strong>
          Type a search term to look up in Exchange
         </strong>
         box.
        </p>
       </li>
       <li>
        <p>
         Select the module name in the list.
        </p>
       </li>
       <li>
        <p>
         Click
         <strong>
          Add
         </strong>
         and then
         <strong>
          Finish
         </strong>
         .
        </p>
       </li>
      </ol>
     </div>
    </div>
    <div class="sect3">
     <h4 id="add-and-configure-secure-configuration-properties-to-your-app">
      <a class="anchor" href="#add-and-configure-secure-configuration-properties-to-your-app">
      </a>
      Add and Configure Secure Configuration Properties to your App
     </h4>
     <div class="olist arabic">
      <ol class="arabic">
       <li>
        <p>
         Go to your Mule app configuration file.
        </p>
       </li>
       <li>
        <p>
         Select
         <strong>
          Global Elements
         </strong>
         tab.
        </p>
       </li>
       <li>
        <p>
         Click
         <strong>
          Create
         </strong>
         .
        </p>
       </li>
       <li>
        <p>
         Select
         <strong>
          Secure Properties Config
         </strong>
         .
        </p>
       </li>
       <li>
        <p>
         Configure the global element with a
         <strong>
          File
         </strong>
         location,
         <strong>
          Key
         </strong>
         ,
         <strong>
          Algorithm
         </strong>
         ,
         <strong>
          Mode
         </strong>
         ,
         <strong>
          Use random IV
         </strong>
         ,
         <strong>
          File level encryption
         </strong>
         , and
         <strong>
          Encoding
         </strong>
         .
        </p>
       </li>
       <li>
        <p>
         Click
         <strong>
          OK
         </strong>
         .
        </p>
       </li>
      </ol>
     </div>
     <div class="imageblock">
      <div class="content">
       <img alt="Configuration panel for secure properties" src="_images/mruntime-secure-config-properties-studio.png"/>
      </div>
     </div>
     <div class="admonitionblock note">
      <table>
       <tr>
        <td class="icon">
         <i class="fa icon-note" title="Note">
         </i>
        </td>
        <td class="content">
         <div class="paragraph">
          <p>
           The
           <code>
            key
           </code>
           ,
           <code>
            algorithm
           </code>
           ,
           <code>
            mode
           </code>
           and
           <code>
            use random IV
           </code>
           values set in the Secure Configuration Properties module must match the values used to encrypt the properties files.
          </p>
         </div>
        </td>
       </tr>
      </table>
     </div>
    </div>
    <div class="sect3">
     <h4 id="verify-secure-configuration-properties-at-development-time">
      <a class="anchor" href="#verify-secure-configuration-properties-at-development-time">
      </a>
      Verify Secure Configuration Properties at Development Time
     </h4>
     <div class="paragraph">
      <p>
       When you are developing applications in Studio, you can verify that secure configurations properties for a connector are set up correctly by testing the connector connection.
The following example shows a Salesforce connector configuration with its secure properties (username, password, and token) encrypted in a
       <code>
        .yaml
       </code>
       file:
      </p>
     </div>
     <div class="imageblock">
      <div class="content">
       <img alt="Configuration panel for a Salesforce connection" src="_images/mruntime-secure-config-properties-studio2.png"/>
      </div>
     </div>
     <div class="paragraph">
      <p>
       The
       <code>
        secure::
       </code>
       prefix is added before the property name definition, to enable access to all values inside a secure properties file, even if the values are not encrypted.
       <br/>
      </p>
     </div>
     <div class="paragraph">
      <p>
       You can click
       <strong>
        Test Connection
       </strong>
       to verify that the connection is functioning as expected and assure that the secure properties are read successfully.
      </p>
     </div>
    </div>
   </div>
  </div>
 </div>
 <div class="sect1">
  <h2 id="file-level-encryption">
   <a class="anchor" href="#file-level-encryption">
   </a>
   File-Level Encryption
  </h2>
  <div class="sectionbody">
   <div class="paragraph">
    <p>
     Since version 1.1.0 of the Secure Configuration Properties module, you can encrypt an entire file rather than only individual properties values. You can encrypt a file both in XML or Anypoint Studio:
    </p>
   </div>
   <div class="paragraph">
    <p>
     In your XML flow, add the
     <code>
      fileLevelEncryption
     </code>
     attribute and set it to
     <code>
      true
     </code>
     :
    </p>
   </div>
   <div class="listingblock">
    <div class="content">
     <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;secure-properties:config key="${runtime.property}" file="file1.yaml" fileLevelEncryption="true" name="test"&gt;
    &lt;secure-properties:encrypt algorithm="AES" mode="CBC"/&gt;
&lt;/secure-properties:config&gt;</code></pre>
    </div>
   </div>
   <div class="paragraph">
    <p>
     In Studio, in Secure Configuration Properties window, select
     <strong>
      True
     </strong>
     for the
     <strong>
      File level encryption
     </strong>
     :
    </p>
   </div>
   <div class="imageblock">
    <div class="content">
     <img alt="Secure properties configuration with AES encryption and CBC mode settings" src="_images/mruntime-secure-config-properties-studio3.png"/>
    </div>
   </div>
  </div>
 </div>
 <div class="sect1">
  <h2 id="secure-configuration-properties-use-cases">
   <a class="anchor" href="#secure-configuration-properties-use-cases">
   </a>
   Secure Configuration Properties Use Cases
  </h2>
  <div class="sectionbody">
   <div class="paragraph">
    <p>
     Review the following uses cases about secure configuration properties, where you can learn how a flow uses encrypted and nonencrypted values, set secure configuration properties files dynamically, and how you can work using more than one configuration file.
    </p>
   </div>
   <div class="sect2">
    <h3 id="encrypted-and-nonencrypted-values">
     <a class="anchor" href="#encrypted-and-nonencrypted-values">
     </a>
     Encrypted and Nonencrypted Values
    </h3>
    <div class="paragraph">
     <p>
      The following example shows how a flow uses the encrypted
      <code>
       encrypted.value1
      </code>
      value to set the payload. At runtime, the decryption algorithm is used to store the decrypted value of
      <code>
       encrypted.value1
      </code>
      into memory.
     </p>
    </div>
    <div class="listingblock">
     <div class="content">
      <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;flow name="main"&gt;
    &lt;set-payload value="${secure::encrypted.value1}"/&gt;
&lt;/flow&gt;</code></pre>
     </div>
    </div>
    <div class="paragraph">
     <p>
      The following example shows how a flow uses a nonencrypted value from the same secure properties file:
     </p>
    </div>
    <div class="listingblock">
     <div class="content">
      <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;flow name="mainNonEncrypted"&gt;
    &lt;set-payload value="${secure::testPropertyA}"/&gt;
&lt;/flow&gt;</code></pre>
     </div>
    </div>
   </div>
   <div class="sect2">
    <h3 id="set-secure-configuration-properties-file-dynamically">
     <a class="anchor" href="#set-secure-configuration-properties-file-dynamically">
     </a>
     Set Secure Configuration Properties File Dynamically
    </h3>
    <div class="paragraph">
     <p>
      A common configuration use case is to set the file to depend on a property (for example,
      <code>
       env
      </code>
      ) to determine which file to use.
      <br/>
      For example, to use a
      <code>
       development-properties
      </code>
      file during the development stage (which could not be encrypted) or a production file (with encrypted values).
     </p>
    </div>
    <div class="paragraph">
     <p>
      <strong>
       Secure Configuration Properties with Environment File Defined
      </strong>
     </p>
    </div>
    <div class="listingblock">
     <div class="content">
      <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;secure-properties:config key="${runtime.property}" file="${env}-properties.yaml" name="test"/&gt;</code></pre>
     </div>
    </div>
    <div class="paragraph">
     <p>
      Using this method, the value of the property
      <code>
       env
      </code>
      determines which file to use to load the secure configuration properties. That
      <code>
       env
      </code>
      property could be set by a
      <code>
       global property
      </code>
      , system property, or environment property.
     </p>
    </div>
    <div class="paragraph">
     <p>
      <strong>
       Secure Global Configuration Properties with Environment File Defined
      </strong>
     </p>
    </div>
    <div class="listingblock">
     <div class="content">
      <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;global-property name="env" value="dev"/&gt;

&lt;secure-properties:config key="${runtime.property}" file="${env}-properties.yaml" name="test"/&gt;</code></pre>
     </div>
    </div>
    <div class="paragraph">
     <p>
      Using this method, the default value for the
      <code>
       env
      </code>
      property is
      <code>
       "dev"
      </code>
      , which can still be overridden with a system or environment property. Note that this is
      <strong>
       required
      </strong>
      for metadata resolution in Anypoint Studio. If you do not define default values for the properties that are passed through the command line, you receive an error when you create the application model for all message processors that depend on those properties.
     </p>
    </div>
   </div>
   <div class="sect2">
    <h3 id="work-with-more-than-one-configuration-file">
     <a class="anchor" href="#work-with-more-than-one-configuration-file">
     </a>
     Work with More Than One Configuration File
    </h3>
    <div class="paragraph">
     <p>
      You can define more than one secure configuration properties file to read properties from. To do so, simply define a
      <code>
       &lt;secure-properties:config /&gt;
      </code>
      tag for each file you want to load. Each secure configuration properties file is independently configured with an encryption algorithm, cipher mode, and encryption/decryption key. These settings do not have to be the same among the files.
      <br/>
      The following example shows how to use more than one configuration file:
     </p>
    </div>
    <div class="listingblock">
     <div class="content">
      <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;secure-properties:config key="${runtime.property}" file="file1.yaml" name="test"&gt;
    &lt;secure-properties:encrypt algorithm="AES" mode="CBC"/&gt;
&lt;/secure-properties:config&gt;

&lt;secure-properties:config key="${runtime.property}" file="file2.yaml" name="otherConfig"&gt;
    &lt;secure-properties:encrypt algorithm="AES" mode="CBC"/&gt;
&lt;/secure-properties:config&gt;</code></pre>
     </div>
    </div>
   </div>
  </div>
 </div>
 <div class="sect1">
  <h2 id="supported-configuration-file-types">
   <a class="anchor" href="#supported-configuration-file-types">
   </a>
   Supported Configuration File Types
  </h2>
  <div class="sectionbody">
   <div class="ulist">
    <ul>
     <li>
      <p>
       Spring-formatted properties:
       <code>
        .properties
       </code>
      </p>
     </li>
     <li>
      <p>
       YAML:
       <code>
        .yaml
       </code>
      </p>
     </li>
    </ul>
   </div>
  </div>
 </div>
 <div class="sect1">
  <h2 id="supported_crypto">
   <a class="anchor" href="#supported_crypto">
   </a>
   Supported Algorithms and Modes
  </h2>
  <div class="sectionbody">
   <div class="sect2">
    <h3 id="supported_algorithms">
     <a class="anchor" href="#supported_algorithms">
     </a>
     Supported Algorithms
    </h3>
    <div class="ulist">
     <ul>
      <li>
       <p>
        AES (default)
       </p>
      </li>
      <li>
       <p>
        Blowfish
       </p>
      </li>
      <li>
       <p>
        DES
       </p>
      </li>
      <li>
       <p>
        DESede
       </p>
      </li>
      <li>
       <p>
        RC2
       </p>
      </li>
      <li>
       <p>
        RCA
       </p>
      </li>
     </ul>
    </div>
    <div class="paragraph">
     <p>
      The following algorithms can be used only if you configure a
      <a href="https://docs.oracle.com/cd/E19830-01/819-4712/ablsc/index.html">
       Java Cryptography Extension (JCE) Provider
      </a>
      that adds support for them:
     </p>
    </div>
    <div class="ulist">
     <ul>
      <li>
       <p>
        Camellia
       </p>
      </li>
      <li>
       <p>
        CAST5
       </p>
      </li>
      <li>
       <p>
        CAST6
       </p>
      </li>
      <li>
       <p>
        Noekeon
       </p>
      </li>
      <li>
       <p>
        Rijndael
       </p>
      </li>
      <li>
       <p>
        SEED
       </p>
      </li>
      <li>
       <p>
        Serpent
       </p>
      </li>
      <li>
       <p>
        Skipjack
       </p>
      </li>
      <li>
       <p>
        TEA
       </p>
      </li>
      <li>
       <p>
        Twofish
       </p>
      </li>
      <li>
       <p>
        XTEA
       </p>
      </li>
      <li>
       <p>
        RC5
       </p>
      </li>
      <li>
       <p>
        RC6
       </p>
      </li>
     </ul>
    </div>
   </div>
   <div class="sect2">
    <h3 id="supported_modes">
     <a class="anchor" href="#supported_modes">
     </a>
     Supported Modes
    </h3>
    <div class="ulist">
     <ul>
      <li>
       <p>
        CBC (default)
       </p>
      </li>
      <li>
       <p>
        CFB
       </p>
      </li>
      <li>
       <p>
        ECB
       </p>
      </li>
      <li>
       <p>
        OFB
       </p>
      </li>
     </ul>
    </div>
   </div>
  </div>
 </div>
 <div class="sect1">
  <h2 id="frequently-asked-questions">
   <a class="anchor" href="#frequently-asked-questions">
   </a>
   Frequently Asked Questions
  </h2>
  <div class="sectionbody">
   <div class="paragraph">
    <p>
     After you learn about, create, and use secure configuration properties files for a while, you might have additional questions about troubleshooting and maximizing their use. Following are some common questions and answers. Refer as well to the topics linked to in See Also.
     <br/>
    </p>
   </div>
   <div class="paragraph">
    <p>
     <strong>
      What if a property is defined in multiple files?
     </strong>
    </p>
   </div>
   <div class="paragraph">
    <p>
     In that case, the actual property’s value will be the one in which is first defined.
    </p>
   </div>
   <div class="paragraph">
    <p>
     <strong>
      Can I define a secure property that depends on a previously defined secure property?
     </strong>
    </p>
   </div>
   <div class="paragraph">
    <p>
     Yes. Just use the same syntax:
     <code>
      property=My dependent ${secure::dependent.property} value
     </code>
     .
    </p>
   </div>
   <div class="paragraph">
    <p>
     Note that secure configuration properties can depend on other secure configuration properties, but not on other Mule configuration properties.
    </p>
   </div>
  </div>
 </div>
 <div class="sect1">
  <h2 id="see-also">
   <a class="anchor" href="#see-also">
   </a>
   See Also
  </h2>
  <div class="sectionbody">
   <div class="ulist">
    <ul>
     <li>
      <p>
       <a class="xref page" href="configuring-properties">
        Configuring Properties
       </a>
      </p>
     </li>
     <li>
      <p>
       <a class="xref page" href="../../anypoint-code-builder/int-create-secure-configs">
        Define and Secure Properties for a Mule Application in Anypoint Code Builder
       </a>
      </p>
     </li>
    </ul>
   </div>
  </div>
 </div>
</article>
